@page "/empresas/create"
@inject IHttpClientFactory ClientFactory
@using System.Net.Http.Json
@using Microsoft.AspNetCore.Components.Forms

<h3>Criar Nova Empresa</h3>

<EditForm Model="@Empresa" OnValidSubmit="Salvar">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label class="form-label">CNPJ</label>
        <InputText class="form-control" @bind-Value="Empresa.Cnpj" />
    </div>

    <div class="mb-3">
        <label class="form-label">Nome</label>
        <InputText class="form-control" @bind-Value="Empresa.Nome" />
    </div>

    <div class="mb-3">
        <label class="form-label">Endereço</label>
        <InputText class="form-control" @bind-Value="Empresa.Endereco" />
    </div>

    <div class="mb-3">
        <label class="form-label">Atividade Principal</label>
        <InputText class="form-control" @bind-Value="Empresa.AtividadePrincipal" />
    </div>

    <button class="btn btn-success" type="submit">Salvar</button>
</EditForm>

@code {
    private HttpClient Http => ClientFactory.CreateClient("ApiClient");
    private EmpresaDto Empresa = new EmpresaDto();

    private async Task Salvar()
    {
        await Http.PostAsJsonAsync("api/empresas", Empresa);
    }

    public class EmpresaDto
    {
        public string? Cnpj { get; set; }
        public string? Nome { get; set; }
        public string? Endereco { get; set; }
        public string? AtividadePrincipal { get; set; }
    }
}
